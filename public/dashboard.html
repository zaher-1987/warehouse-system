<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üì¶ Warehouse Dashboard</title>
  <!-- existing styles here -->
</head>
<body>
  <!-- existing body content here -->

  <script>
    // existing JavaScript code here
  </script>

<!-- üèóÔ∏è Add Warehouse Modal (admin only) -->
<div id="addWarehouseModal" style="display:none; position:fixed; top:20%; left:50%; transform:translate(-50%, -20%);
    background:white; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.2); z-index:1000;">
  <h3>Add New Warehouse</h3>
  <label>Name: <input type="text" id="newWarehouseName" style="padding:5px;"/></label><br><br>
  <button onclick="submitNewWarehouse()" style="padding:8px 16px;">‚úÖ Save</button>
  <button onclick="document.getElementById('addWarehouseModal').style.display='none'" style="padding:8px 16px;">‚ùå Cancel</button>
</div>

<script>
  function openAddWarehouseModal() {
    document.getElementById('addWarehouseModal').style.display = 'block';
  }

  async function submitNewWarehouse() {
    const name = document.getElementById('newWarehouseName').value.trim();
    if (!name) return alert('Warehouse name is required');

    const res = await fetch('/warehouses', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name })
    });

    if (res.ok) {
      alert('‚úÖ Warehouse added successfully');
      location.reload();
    } else {
      alert('‚ùå Failed to add warehouse');
    }
  }

  async function maybeShowAddWarehouseBtn() {
    const res = await fetch('/session-status');
    const data = await res.json();
    if (data.loggedIn && data.user.role === 'admin') {
      const btn = document.createElement('button');
      btn.innerHTML = '‚ûï Add Warehouse';
      btn.onclick = openAddWarehouseModal;
      btn.style = "background:#5cb85c; color:white; padding:10px 16px; border:none; border-radius:4px; margin-right:10px;";
      document.querySelector('h2').insertAdjacentElement('afterend', btn);
    }
  }
  maybeShowAddWarehouseBtn();
</script>

</body>
</html>
