
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>📦 Warehouse Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 30px; background: #f4f6f8; position: relative; }
    h2 { margin-bottom: 10px; }
    /* ... rest of your styles ... */
  </style>
</head>
<body>
  <!-- Admin buttons -->
  <a class="logout" href="/logout">🚪 Logout</a>
  <a class="ticket-button" id="viewTicketsBtn" href="/ticket-view.html" style="display:none;">🎫 View Tickets</a>
  <button id="createWarehouseBtn" style="display:none;">➕ Create Warehouse</button>

  <h2>📦 Warehouse Inventory Dashboard</h2>
  <p id="userWarehouseInfo">Checking session...</p>
  <!-- Modal for create warehouse -->
  <div id="createWarehouseModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeWarehouseModal()">×</span>
      <h3>Create New Warehouse</h3>
      <input id="warehouseNameInput" placeholder="Enter warehouse name" style="padding:8px; width: 80%;" />
      <button onclick="submitNewWarehouse()">✅ Save</button>
    </div>
  </div>
  <script>
    async function checkSession() {
      const res = await fetch('/session-status');
      const data = await res.json();
      if (data?.user?.role === 'admin') {
        document.getElementById("createWarehouseBtn").style.display = "inline-block";
      }
    }
    document.getElementById("createWarehouseBtn")?.addEventListener("click", () => {
      document.getElementById("createWarehouseModal").style.display = "block";
    });
    function closeWarehouseModal() {
      document.getElementById("createWarehouseModal").style.display = "none";
    }
    async function submitNewWarehouse() {
      const name = document.getElementById("warehouseNameInput").value;
      if (!name) return alert("Warehouse name required.");
      const res = await fetch('/create-warehouse', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ warehouse_name: name })
      });
      const result = await res.json();
      if (result.success) {
        alert("✅ Warehouse added.");
        closeWarehouseModal();
        location.reload();
      } else {
        alert("❌ Failed: " + result.message);
      }
    }
    checkSession();
  </script>
</body>
</html>
